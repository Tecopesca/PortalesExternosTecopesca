<app-header titulo ="Administración documentos" lug="colaboradores"> </app-header> 


<ion-content>
    <ion-grid>
        <ion-row>
            <ion-col size-xs="0" size-sm="0" size-md="1" size-lg="1" class="sin-padding"></ion-col>
            <ion-col size-xs="12" size-sm="12" size-md="10" size-lg="10" class="sin-padding">
                <ion-grid>
                    <ion-row>
                        <ion-col size-xs="12" size-sm="12" size="4" size-lg="4" class="sin-padding">
                            <ion-grid>
                                <ion-row>
                                    <ion-col size-xs="12" size-sm="12" size="2" size-lg="2" class="sin-padding">
                                        <label class="label-colaborador-administracion">Mes</label>
                                    </ion-col>
                                    <ion-col size-xs="12" size-sm="12" size="10" size-lg="10" class="sin-padding">
                                        <input type="date" [(ngModel)]="elementos.mes" (ngModelChange)="traerResumenCompra()" style="width: 100%;">
                                    </ion-col>
                                </ion-row>
                            </ion-grid>
                        </ion-col>
                        <ion-col size-xs="12" size-sm="12" size="8" size-lg="8" class="sin-padding">
                            <ion-grid>
                                <ion-row>
                                    <ion-col size-xs="12" size-sm="12" size="2" size-lg="2" class="sin-padding">
                                        <label class="label-colaborador-administracion">No. compra</label>
                                    </ion-col>
                                    <ion-col size-xs="12" size-sm="12" size="10" size-lg="10" class="sin-padding">
                                        <ng-select2 
                                            [(ngModel)]="elementos.numeroFactura"
                                            [data]="dataNumeroFactura"
                                            [options]="configSelect"
                                            [placeholder]="'Seleccione número de compra'"
                                            [allowClear]="true"
                                            (ngModelChange)="datosCompra()"
                                        >
                                        </ng-select2>
                                    </ion-col>
                                </ion-row>
                            </ion-grid>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" class="linea"></ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" class="subtitulo">
                            <label class="label-colaborador2">Ficha barco</label>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" class="sin-padding">
                            <div class="div-en-linea-administracion-doc">
                                <label for="codigo" class="label-colaborador-administracion">Código: </label> <span id="codigo" class="span-colaborador">{{elementos.codigoBarco}}</span>
                            </div>

                            <div class="div-en-linea-administracion-doc">
                                <label for="nombre" class="label-colaborador-administracion">Nombre: </label> <span id="nombre" class="span-colaborador">{{elementos.nombreBarco}}</span>
                            </div>

                            <div class="div-en-linea-administracion-doc">
                                <label for="bandera" class="label-colaborador-administracion">Bandera: </label> <span id="bandera" class="span-colaborador">{{elementos.banderaBarco}}</span>
                            </div>

                            <div class="div-en-linea-administracion">
                                <label for="registro" class="label-colaborador-administracion">No. reg. internacional: </label> <input id="registro" type="text" [(ngModel)]="elementos.numeroRegistroInternacional" class="text-colaborador2-administracion">
                            </div>

                            <div class="div-en-linea-administracion">
                                <label for="cod-imo" class="label-colaborador-administracion">Cod. IMO: </label> <input id="cod-imo" type="text" [(ngModel)]="elementos.codigoImo" class="text-colaborador2-administracion">
                            </div>

                            <div class="div-en-linea-administracion">
                                <label for="cod-licencia" class="label-colaborador-administracion">Cod. Licencia: </label> <input id="cod-licencia" type="text" [(ngModel)]="elementos.codigoLicencia" class="text-colaborador2-administracion">
                            </div>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" class="sin-padding">
                            <div class="div-en-linea-administracion">
                                <label for="cod-sanco" class="label-colaborador-administracion">Cod. SANCO: </label> <input id="cod-sanco" type="text" [(ngModel)]="elementos.codigoSanco" class="text-colaborador2-administracion">
                            </div>
                            <div class="div-en-linea-administracion">
                                <label for="fecha-venc" class="label-colaborador-administracion">Fecha venc. Licencia: </label> <input id="fecha-venc" type="date" [(ngModel)]="elementos.fechaVenceLicencia" class="text-colaborador2-administracion">
                            </div>
                            <div class="div-en-linea-administracion">
                                <label for="codigo-senae" class="label-colaborador-administracion">Cod. senae: </label> <input id="codigo-senae" type="text" [(ngModel)]="elementos.codigoSenae" class="text-colaborador2-administracion">
                            </div>
                            <div class="div-en-linea-administracion">
                                <label for="codigo-bue" class="label-colaborador-administracion">Cod. bue: </label> <input id="codigo-bue" type="text" [(ngModel)]="elementos.codigoBue" class="text-colaborador2-administracion">
                            </div>
                            <div class="div-en-linea-administracion-doc">
                                <ion-button type="button" small class="botones" (click)="modificarBarco()">
                                    <ion-icon name="save-outline" style="padding-right: 5px;"></ion-icon> GUARDAR
                                </ion-button>
                            </div>
                            <div class="div-en-linea-administracion-doc">
                                <ion-button type="button" small class="botones" (click)="notificarCompra()">
                                    <ion-icon name="mail-outline" style="padding-right: 5px;"></ion-icon> NOTIFICAR
                                </ion-button>
                            </div>
                            <div class="div-en-linea-administracion">
                                <ion-button type="button" small class="botones" (click)="sincronizar2c()">
                                    <ion-icon name="refresh-outline" style="padding-right: 5px;"></ion-icon> SINCRONIZAR DOCUMENTOS
                                </ion-button>
                            </div>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col size-xs="12" size-sm="12" size-md="12" size-lg="12" class="linea"></ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col size-xs="3" size-sm="9" size-md="9" size-lg="9" style="text-align: right;"></ion-col>
                        <ion-col size-xs="3" size-sm="1" size-md="1" size-lg="1" style="text-align: right;">
                            <ion-button class="boton-accion" small (click)="confirmarModDocumento()">
                                <ion-icon name="save"></ion-icon>
                            </ion-button>
                            <label class="label-accion"> Guardar</label>
                        </ion-col>
                        <ion-col size-xs="3" size-sm="1" size-md="1" size-lg="1">
                            <ion-button class="boton-accion" small (click)="cancelarEdicion()">
                                <ion-icon name="close"></ion-icon>
                            </ion-button>
                            <label class="label-accion"> Cancelar</label>
                        </ion-col>
                        <ion-col size-xs="3" size-sm="1" size-md="1" size-lg="1">
                            <ion-button class="boton-accion" small (click)="actualizarTabla()">
                                <ion-icon name="refresh"></ion-icon>
                            </ion-button>
                            <label class="label-accion"> Actualizar</label>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col class="sin-padding">
                            <ngx-datatable
                                #mydatatable
                                class="material bordes-redondeados5"
                                [columnMode]="ColumnMode.force"
                                footerHeight="50"
                                rowHeight="auto"
                                [rows]="rows"
                                [loadingIndicator]="true"
                                [scrollbarH]="true"
                                >
                                <!-- [limit]="10" -->
                                <ngx-datatable-column name="Estado" prop="estado.estado" [cellClass]="getCellClass"></ngx-datatable-column>
                                <ngx-datatable-column name="Nomenclatura" prop="nomenclatura" width="240"></ngx-datatable-column>
                                <ngx-datatable-column name="Nombre Documento" prop="nombre" width="200"></ngx-datatable-column>
                                <ngx-datatable-column name="Observación" prop="observacion">
                                    <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
                                        <div
                                            title="Click para editar"
                                            (click)="editing[rowIndex + '-name'] = true"
                                            class="label-celda"
                                            *ngIf="!editing[rowIndex + '-name']"
                                        >
                                            {{ value }}
                                        </div>
                                        <input
                                            autofocus
                                            (blur)="updateValue($event, 'name', rowIndex)"
                                            *ngIf="editing[rowIndex + '-name']"
                                            type="text"
                                            [value]="value"
                                        />
                                    </ng-template>
                                </ngx-datatable-column>
                                <ngx-datatable-column name="Cargar documentos" prop="accion" width="200">
                                    <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
                                        <ion-button small class="boton-accion" title="Imprimir Documento" (click)="documentoTraer(value.id)">
                                            <ion-icon name="document-outline"></ion-icon>
                                        </ion-button>
                                        <input hidden type="file" accept=".pdf" [id]="value.idFile" [name]="value.idFile" [(ngModel)]="elementos.archivo[value.idFile]" (change)="cargaArchivo($event.target.files,value.idFile,value.id)" />
                                        <ion-button small title="Seleccione archivo" class="carga-archivo" (click)="llamarFile(value.idFile)">
                                            Seleccionar Archivo <ion-badge color="light">{{ totalArchivoCargado[value.idFile] ? totalArchivoCargado[value.idFile] : 0}}</ion-badge>
                                        </ion-button>
                                    </ng-template>
                                </ngx-datatable-column>
                            </ngx-datatable>
                        </ion-col>
                    </ion-row>
                </ion-grid>
            </ion-col>
            <ion-col size-xs="0" size-sm="0" size-md="1" size-lg="1" class="sin-padding"></ion-col>
        </ion-row>
    </ion-grid>
</ion-content>
